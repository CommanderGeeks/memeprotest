<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit a Protest - The Meme Protest</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .submit-header {
            background: linear-gradient(135deg, var(--hot-pink) 0%, var(--neon-green) 100%);
            padding: 3rem 2rem;
            text-align: center;
            margin-bottom: 3rem;
        }

        .submit-header h1 {
            color: var(--black);
            font-size: 4rem;
            margin-bottom: 0.5rem;
        }

        .submit-header p {
            color: var(--black);
            font-size: 1.2rem;
            font-weight: 600;
        }

        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--dark-gray);
            padding: 3rem;
            border: 2px solid var(--medium-gray);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            color: var(--neon-green);
            font-family: 'Bebas Neue', Impact, sans-serif;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            letter-spacing: 1px;
        }

        .form-group .hint {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            font-family: 'Inter', sans-serif;
        }

        .required {
            color: var(--hot-pink);
        }

        .char-counter {
            text-align: right;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 0.3rem;
        }

        .char-counter.warning {
            color: var(--hot-pink);
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        .image-upload-area {
            border: 3px dashed var(--medium-gray);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--black);
        }

        .image-upload-area:hover {
            border-color: var(--neon-green);
            background: var(--dark-gray);
        }

        .image-upload-area.has-image {
            border-color: var(--neon-green);
            padding: 1rem;
        }

        .image-preview {
            max-width: 100%;
            max-height: 400px;
            margin: 1rem auto;
            display: block;
        }

        .upload-prompt {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--neon-green);
            margin-bottom: 1rem;
        }

        #imageInput {
            display: none;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            .submit-header h1 {
                font-size: 2.5rem;
            }

            .form-container {
                padding: 1.5rem;
            }

            .form-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">âš¡ The Meme Protest</a>
            <ul class="nav-links">
                <li><a href="browse.html">Browse</a></li>
                <li><a href="submit.html">Submit</a></li>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="roadmap.html">Roadmap</a></li>
            </ul>
        </div>
    </nav>

    <div class="submit-header">
        <h1>START A PROTEST</h1>
        <p>Your voice. Your meme. Your movement. Let's change the world.</p>
    </div>

    <main class="container">
        <form class="form-container" id="protestForm">
            <div class="form-group">
                <label for="title">Protest Title <span class="required">*</span></label>
                <span class="hint">Make it bold. Make it clear. (Max 100 characters)</span>
                <input 
                    type="text" 
                    id="title" 
                    name="title" 
                    maxlength="100" 
                    required
                    placeholder="e.g., Free Pizza Fridays or We Riot"
                >
                <div class="char-counter" id="titleCounter">0 / 100</div>
            </div>

            <div class="form-group">
                <label for="summary">Protest Summary <span class="required">*</span></label>
                <span class="hint">Tell us why this matters. What are you fighting for? (Max 250 words)</span>
                <textarea 
                    id="summary" 
                    name="summary" 
                    required
                    placeholder="This is about more than just pizza. This is about dignity, community, and standing up for what really matters..."
                ></textarea>
                <div class="char-counter" id="summaryCounter">0 / 250 words</div>
            </div>

            <div class="form-group">
                <label for="memeImage">Meme Image <span class="required">*</span></label>
                <span class="hint">The heart of your protest. Upload a meme that captures your message.</span>
                <div class="image-upload-area" id="uploadArea" onclick="document.getElementById('imageInput').click()">
                    <div id="uploadPrompt">
                        <div class="upload-icon">ðŸ“¸</div>
                        <p class="upload-prompt">Click to upload your meme</p>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">
                            Accepted formats: JPG, PNG, GIF
                        </p>
                    </div>
                    <img id="imagePreview" class="image-preview" style="display: none;">
                </div>
                <input 
                    type="file" 
                    id="imageInput" 
                    name="memeImage" 
                    accept="image/*" 
                    required
                >
            </div>

            <div class="form-group">
                <label for="university">University / Location</label>
                <span class="hint">Optional - Where is this protest happening?</span>
                <select id="university" name="university">
                    <option value="Independent">Independent / Not Affiliated</option>
                    <option value="State University">State University</option>
                    <option value="Metro Tech">Metro Tech</option>
                    <option value="Business College">Business College</option>
                    <option value="Green University">Green University</option>
                    <option value="Liberty College">Liberty College</option>
                    <option value="Community College">Community College</option>
                    <option value="Arts Institute">Arts Institute</option>
                </select>
            </div>

            <div class="form-group">
                <label for="organizer">Your Name / Pseudonym <span class="required">*</span></label>
                <span class="hint">How should people know you? Real name or alias - your choice.</span>
                <input 
                    type="text" 
                    id="organizer" 
                    name="organizer" 
                    required
                    placeholder="e.g., PizzaWarrior2026"
                >
            </div>

            <div class="form-group">
                <label for="contact">Contact Method (Optional)</label>
                <span class="hint">Email or social media handle. Supporters will see this when they upvote your protest.</span>
                <input 
                    type="text" 
                    id="contact" 
                    name="contact"
                    placeholder="e.g., pizzaprotest@proton.me or @username"
                >
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Launch Protest</button>
                <a href="browse.html" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </main>

    <footer>
        <p>&copy; 2026 The Meme Protest. A movement, not an organization. Started by students who believed memes could change the world.</p>
        <p style="margin-top: 0.5rem; color: var(--neon-green);">Armed with memes. Powered by passion. Built for the future.</p>
    </footer>

    <script src="shared.js"></script>
    <script>
        const titleInput = document.getElementById('title');
        const summaryInput = document.getElementById('summary');
        const imageInput = document.getElementById('imageInput');
        const imagePreview = document.getElementById('imagePreview');
        const uploadArea = document.getElementById('uploadArea');
        const uploadPrompt = document.getElementById('uploadPrompt');
        const organizerInput = document.getElementById('organizer');

        let imageData = null;

        // Character counters
        titleInput.addEventListener('input', () => {
            const count = titleInput.value.length;
            const counter = document.getElementById('titleCounter');
            counter.textContent = `${count} / 100`;
            counter.classList.toggle('warning', count > 90);
        });

        summaryInput.addEventListener('input', () => {
            const words = summaryInput.value.trim().split(/\s+/).filter(w => w.length > 0);
            const wordCount = words.length;
            const counter = document.getElementById('summaryCounter');
            counter.textContent = `${wordCount} / 250 words`;
            counter.classList.toggle('warning', wordCount > 240);
        });

        // Image upload
        imageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    imageData = event.target.result;
                    imagePreview.src = imageData;
                    imagePreview.style.display = 'block';
                    uploadPrompt.style.display = 'none';
                    uploadArea.classList.add('has-image');
                };
                reader.readAsDataURL(file);
            }
        });

        // Pre-fill organizer if user already has a username
        const currentUser = getCurrentUser();
        if (currentUser.username) {
            organizerInput.value = currentUser.username;
        }

        // Form submission
        document.getElementById('protestForm').addEventListener('submit', (e) => {
            e.preventDefault();

            // Validate word count
            const words = summaryInput.value.trim().split(/\s+/).filter(w => w.length > 0);
            if (words.length > 250) {
                alert('Summary must be 250 words or less!');
                return;
            }

            // Validate image
            if (!imageData) {
                alert('Please upload a meme image!');
                return;
            }

            // Get form data
            const protestData = {
                title: titleInput.value.trim(),
                summary: summaryInput.value.trim(),
                memeUrl: imageData,
                university: document.getElementById('university').value,
                organizer: organizerInput.value.trim(),
                contact: document.getElementById('contact').value.trim()
            };

            // Set username if not set
            if (!currentUser.username) {
                setUsername(protestData.organizer);
            }

            // Add protest
            const protestId = addProtest(protestData);

            // Show success message
            alert('ðŸ”¥ Protest launched! The revolution begins now.');

            // Redirect to the new protest page
            window.location.href = `protest.html?id=${protestId}`;
        });
    </script>
</body>
</html>
